<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Chauffeur Dashboard | DVK</title>
  <link rel="stylesheet" href="../public/css/style.css?v=1" />

  <style>
    .seg { display:inline-flex; border:1px solid rgba(255,255,255,.10); border-radius:12px; overflow:hidden; }
    .seg button { padding:10px 12px; background:rgba(255,255,255,.04); border:0; color:#fff; cursor:pointer; }
    .seg button.active { background:rgba(34,197,94,.18); }

    .status-btn.active-green{
      border-color: rgba(34,197,94,.55) !important;
      background: rgba(34,197,94,.18) !important;
      box-shadow: 0 0 0 3px rgba(34,197,94,.12);
    }

    .modal-backdrop{ position:fixed; inset:0; background:rgba(0,0,0,.55); display:none; align-items:center; justify-content:center; padding:16px; z-index:999; }
    .modal{ width:min(940px, 96vw); background:#0f1a2c; border:1px solid rgba(255,255,255,.10); border-radius:16px; padding:16px; max-height:92vh; overflow:auto; }
    .row{ display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
    .space{ justify-content:space-between; }
    .inp{ width:100%; padding:10px 12px; border-radius:12px; border:1px solid rgba(255,255,255,.10); background:rgba(255,255,255,.04); color:#fff; }
    .lbl{ display:block; margin:0 0 6px 0; opacity:.75; font-size:13px; }
    .btn{ padding:10px 12px; border-radius:12px; border:1px solid rgba(255,255,255,.10); background:rgba(255,255,255,.04); color:#fff; cursor:pointer; }
    .btn.primary{ background:#3b82f6; border-color:#3b82f6; }
    .btn.warn{ background:rgba(245,158,11,.18); border-color:rgba(245,158,11,.35); }
    .btn.ok{ background:rgba(34,197,94,.18); border-color:rgba(34,197,94,.35); }
    .btn.small{ padding:8px 10px; border-radius:10px; font-size:13px; }

    .table-wrap{ overflow:auto; margin-top:12px; }
    table{ width:100%; border-collapse:collapse; }
    th,td{ padding:10px; border-bottom:1px solid rgba(255,255,255,.08); text-align:left; }
    th{ opacity:.7; }

    canvas{ width:100%; height:220px; background:#fff; border-radius:12px; border:1px solid rgba(0,0,0,.15); }
    .msg{ display:none; padding:10px 12px; border-radius:12px; border:1px solid rgba(255,255,255,.10); margin-top:10px;}
    .msg.bad{ background:rgba(239,68,68,.12); border-color:rgba(239,68,68,.35); }
    .msg.ok{ background:rgba(34,197,94,.12); border-color:rgba(34,197,94,.35); }
    .muted{ opacity:.7; }

    .filelist { margin-top:8px; display:flex; flex-direction:column; gap:6px; }
    .chip { display:inline-flex; align-items:center; gap:8px; padding:8px 10px; border:1px solid rgba(255,255,255,.10); border-radius:999px; background:rgba(255,255,255,.03); }
  </style>
</head>

<body>
  <main style="max-width:1100px;margin:20px auto;padding:0 14px;">
    <div style="border:1px solid rgba(255,255,255,.08);border-radius:16px;padding:16px;background:rgba(255,255,255,.02);">
      <div class="row space">
        <div>
          <div style="font-size:22px;font-weight:800;">De Vechtse Koeriers</div>
          <div class="muted">Chauffeur Dashboard</div>
          <div class="muted" style="margin-top:6px;">Ingelogd als <b id="userEmail">-</b></div>
        </div>

        <div class="row">
          <div class="seg" title="Open / Archief">
            <button id="tabOpen" class="active" type="button">Open</button>
            <button id="tabArchive" type="button">Archief</button>
          </div>
          <button id="newBtn" class="btn primary" type="button">+ Nieuwe zending</button>
          <button id="logoutBtn" class="btn" type="button">Uitloggen</button>
        </div>
      </div>

      <div id="pageMsg" class="msg bad"></div>

      <div class="table-wrap">
        <table>
          <thead>
            <tr>
              <th>Trackcode</th>
              <th>Klant</th>
              <th>Status</th>
              <th>Colli</th>
              <th>Kg</th>
              <th>Bijgewerkt</th>
              <th>Acties</th>
            </tr>
          </thead>
          <tbody id="tbody">
            <tr><td colspan="7" class="muted">Ladenâ€¦</td></tr>
          </tbody>
        </table>
      </div>
    </div>
  </main>

  <!-- Modal: Wijzigen / status -->
  <div id="modalBackdrop" class="modal-backdrop">
    <div class="modal">
      <div class="row space">
        <div style="font-weight:800;font-size:18px;">Wijzigen</div>
        <div class="row">
          <button id="pdfBtn" class="btn ok" type="button">PDF (Afleverbon / POD)</button>
          <button id="closeModalBtn" class="btn" type="button">Sluiten</button>
        </div>
      </div>

      <div class="muted" style="margin-top:8px;">Trackcode: <b id="mTrack">-</b></div>
      <div class="muted" style="margin-top:4px;">Huidige status: <b id="mStatus">-</b></div>

      <div id="modalMsg" class="msg bad"></div>
      <div id="modalOk" class="msg ok"></div>

      <div class="row" style="margin-top:14px;">
        <button id="btnPickup" class="btn status-btn" type="button">Opgehaald</button>
        <button id="btnTransit" class="btn status-btn" type="button">Onderweg</button>
        <button id="btnDelivered" class="btn status-btn" type="button">Afgeleverd</button>
        <button id="btnProblem" class="btn status-btn warn" type="button">Probleem</button>
      </div>

      <div class="row" style="margin-top:14px; align-items:flex-start;">
        <div style="flex:1; min-width:240px;">
          <label class="lbl">Ontvangen door (alleen bij Afgeleverd)</label>
          <input id="receiverName" class="inp" placeholder="Naam / receptie" />
        </div>
        <div style="flex:1; min-width:240px;">
          <label class="lbl">Notitie (optioneel)</label>
          <input id="note" class="inp" placeholder="Bijv. afgeleverd receptie / niemand thuis" />
        </div>
      </div>

      <div style="margin-top:14px;">
        <label class="lbl">Handtekening (alleen bij Afgeleverd)</label>
        <canvas id="sig" width="900" height="440"></canvas>
        <div class="row" style="justify-content:flex-end; margin-top:10px;">
          <button id="clearSigBtn" class="btn" type="button">Wis</button>
          <button id="saveBtn" class="btn primary" type="button">Opslaan</button>
        </div>
      </div>

      <div style="margin-top:14px;">
        <label class="lbl">Afleverdocument / Foto (max 2)</label>
        <input id="proofFiles" class="inp" type="file" multiple accept="image/*,application/pdf" />
        <div class="muted" style="margin-top:6px;">Tip: kies max 2 bestanden. (jpg/png/pdf)</div>
        <div id="proofList" class="filelist"></div>
      </div>

      <div class="row space" style="margin-top:14px;">
        <label class="muted" style="display:flex;gap:10px;align-items:center;">
          <input id="isClosed" type="checkbox" />
          Naar archief (afgehandeld)
        </label>

        <label class="muted" style="display:flex;gap:10px;align-items:center;">
          <input id="autoPod" type="checkbox" checked />
          Bij archiveren POD PDF opslaan
        </label>
      </div>
    </div>
  </div>

  <!-- Supabase -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <!-- jsPDF (PDF maken) -->
  <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>

  <script src="../public/js/supabase-config.js?v=1"></script>
  <script src="../public/js/dashboard.js?v=1"></script>
</body>
</html>
